# Text2SVG

üåê –î–æ—Å—Ç—É–ø–Ω—ã–µ —è–∑—ã–∫–∏: [English](README.md) | [–†—É—Å—Å–∫–∏–π](README.ru.md)

Text2SVG ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –æ–ø–∏—Å–∞–Ω–∏—è –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ SVG –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–∞.  
–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä—ë—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Ñ–æ—Ä–º–∏—Ä—É—é—â–∏—Ö –ø–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω: –æ—Ç —Å–±–æ—Ä–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö SVG-—Ñ–∞–π–ª–æ–≤ –¥–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö SVG —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ë–Ø–ú.

```
Text2SVG
‚îú‚îÄ‚îÄ svg-corpus         
‚îÇ   ‚îú‚îÄ‚îÄ mining         # –°–∫—Ä–∞–ø–∏–Ω–≥ SVG
‚îÇ   ‚îú‚îÄ‚îÄ optimization   # –î–≤—É—Ö—ç—Ç–∞–ø–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ captioning     # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏–π —Å –ø–æ–º–æ—â—å—é VLM
‚îú‚îÄ‚îÄ llm4svg            # –î–æ–æ–±—É—á–µ–Ω–∏–µ –ë–Ø–ú –ø–æ–¥ –¥–æ–º–µ–Ω SVG
‚îî‚îÄ‚îÄ svg-encoder        # –≠–Ω–∫–æ–¥–µ—Ä SVG
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
git clone https://github.com/CTLab-ITMO/Text2SVG
cd Text2SVG
pip install .
apt update && apt install libcairo2
```

## –ü–∞–π–ø–ª–∞–π–Ω —Å–±–æ—Ä–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ—Ä–ø—É—Å–∞ SVG

<img src="imgs/svg-corpus_flow.png" alt="svg corpus" width="600"/>

### –°–±–æ—Ä SVG
[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1QVc6mTDZSI9ZyU5L-bc3yYwIIz4Nrxka?usp=sharing)

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–±–æ—Ä–∞ SVG-—Ñ–∞–π–ª–æ–≤ —Å —Å–∞–π—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ URL –∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ HuggingFace.  
–°–æ–±–∏—Ä–∞–µ—Ç –æ–∫–æ–ª–æ 4 –º–∏–ª–ª–∏–æ–Ω–æ–≤ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –º–µ—Å—è—Ü —Å —É—á—ë—Ç–æ–º –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏.

<img src="https://github.com/CTLab-ITMO/Text2SVG/blob/main/imgs/One-Month%20Extrapolation.png" alt="Growth projection showing sublinear scaling due to deduplication" width="600"/>

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd Text2SVG/svg-corpus/mining
pip install -r requirements.txt
```

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞

–í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å –ª—é–±–æ–π –¥–∞—Ç–∞—Å–µ—Ç –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ HuggingFace, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∫–æ–ª–æ–Ω–∫—É —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º url.

```bash
python3 main.py --dataset nhagar/fineweb_urls --output-dir /path/to/output
```

#### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∑–∞–ø—É—Å–∫–∞:

- **`--max-concurrency`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 500): –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤.

- **`--batch-size`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50000): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ URL, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –∑–∞ –æ–¥–∏–Ω –ø–∞–∫–µ—Ç.

- **`--timeout`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1): –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ HTTP-–∑–∞–ø—Ä–æ—Å–∞. –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å "–º–µ–¥–ª–µ–Ω–Ω—ã–µ" —Å–∞–π—Ç—ã.

```bash
python3 main.py \
  --dataset nhagar/fineweb_urls \
  --column url \
  --output-dir /path/to/output \
  --max-concurrency 500 \
  --batch-size 50000 \
  --timeout 1 \
  --start-offset 0 \
  --debug
```

#### –§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

SVG-—Ñ–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONL, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å–∞–º —Ö—ç—à–µ–π MD5:

```json
{
  "url": "https://example.com/page",
  "timestamp": "2024-03-21T10:30:45.123456",
  "svg": "<svg>...</svg>"
}
```

**–ü—Ä–∏–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞:**  
–ù–µ–±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö SVG –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ [—Å—Å—ã–ª–∫–µ](https://huggingface.co/datasets/VectorGraphics/open-svg).

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è


[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/14HTBFO7PNMj5uFQrOGfv0fStjkca_mjk?usp=sharing)

–î–≤—É—Ö—ç—Ç–∞–ø–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ SVG-—Ñ–∞–π–ª–æ–≤:

1. **–≠—Ç–∞–ø 1:** –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∫ –¥–∏–∞–ø–∞–∑–æ–Ω—É [0, 256]
2. **–≠—Ç–∞–ø 2:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å –ø–æ–º–æ—â—å—é SVGO –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∏ —É–¥–∞–ª–µ–Ω–∏—è –ª–∏—à–Ω–µ–≥–æ

#### Python API

```python
from optimization import optimize_svg_string

# Basic optimization
result = optimize_svg_string(svg_string)

# With custom options
result = optimize_svg_string(
    svg_string=svg_text,
    stage1_opts={
        "normalize_scale": 256.0,
        "cubic_only": True,
        "normalize_to_int": False
    },
    stage2_config_path='./svgo.config.mjs',
    quiet=True
)
```

#### CLI

```bash
optimize_dir \
  --input_dir ./raw_svgs \
  --output_dir ./optimized_svgs \
  --cubic_only \
  --normalize_points \
  --normalize_scale 256 \
  --num_threads 4 \
  --svgo_config ./svgo.config.mjs
```

#### –ü—Ä–∏–º–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–æ/–ø–æ—Å–ª–µ

**–î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (648 —Å–∏–º–≤–æ–ª–æ–≤):**
```xml
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20">
<title>power</title>
<path d="M10.625 1.681c0-0.345-0.28-0.625-0.625-0.625s-0.625 0.28-0.625 0.625v8.125c0 0.345 0.28 0.625 0.625 0.625s0.625-0.28 0.625-0.625v-8.125z"></path>
<path d="M7.12 2.881c0.318-0.135 0.466-0.502 0.33-0.82s-0.502-0.466-0.82-0.33c-3.156 1.343-5.38 4.436-5.38 8.075 0 4.845 3.905 8.75 8.75 8.75s8.75-3.905 8.75-8.75c0-3.639-2.225-6.732-5.38-8.075-0.318-0.135-0.685 0.013-0.82 0.33s0.013 0.685 0.33 0.82c2.719 1.157 4.62 3.814 4.62 6.925 0 4.155-3.345 7.5-7.5 7.5s-7.5-3.345-7.5-7.5c0-3.111 1.9-5.768 4.62-6.925z"></path>
</svg>
```

<img src="https://github.com/CTLab-ITMO/Text2SVG/blob/main/imgs/example_1_before_optimization.png?raw=true" alt="Before optimization" width="200"/>

**–ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (343 —Å–∏–º–≤–æ–ª–∞, —Å–∂–∞—Ç–∏–µ –Ω–∞ 47%):**
```xml
<svg viewBox="0 0 256 256">
  <path d="M136 22Q135 14 128 14T120 22V126Q121 133 128 134 135 133 136 126z"/>
  <path d="M91 37Q98 33 95 26 92 20 85 22C44 39 16 79 16 126 16 188 66 238 128 238S240 188 240 126C240 79 212 39 171 22Q164 20 161 26 158 33 165 37C200 52 224 86 224 126 224 179 181 222 128 222S32 179 32 126C32 86 56 52 91 37"/>
</svg>
```

<img src="https://github.com/CTLab-ITMO/Text2SVG/blob/main/imgs/example_1_after_optimization.png?raw=true" alt="After optimization" width="200"/>

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏–π SVG —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º VLM —á–µ—Ä–µ–∑ [LMDeploy](https://github.com/InternLM/lmdeploy).  
–ü–∞–π–ø–ª–∞–π–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª—é–±—ã–µ –º–æ–¥–µ–ª–∏, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Å LMDeploy, –≤–∫–ª—é—á–∞—è InternVL, Qwen2-VL –∏ –¥—Ä.

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
cd Text2SVG/svg-corpus/captioning
pip install lmdeploy timm
```

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞

```bash
python caption_intern.py \
  --dataset VectorGraphics/svg-corpus \
  --output captions.jsonl \
  --model OpenGVLab/InternVL3-2B
```

#### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
python caption_intern.py \
  --dataset VectorGraphics/svg-corpus \
  --output detailed_captions.jsonl \
  --model OpenGVLab/InternVL3-8B \
  --batch-size 32 \
  --resolution 224 \
  --temperature 0.1 \
  --tp 1 \
  --max-samples 100_000
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä         | –¢–∏–ø   | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é                        | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------------|--------|--------------------------------------|----------|
| `--model`        | str    | `OpenGVLab/InternVL3-2B`             | –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏–ª–∏ –ø—É—Ç—å (–ª—é–±–∞—è VLM, —Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è —Å LMDeploy) |
| `--dataset`      | str    | `VectorGraphics/svg-corpus`         | –ò–º—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏–ª–∏ –ø—É—Ç—å –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É JSONL-—Ñ–∞–π–ª—É |
| `--data-files`   | str    | `*_stage2*`                          | –®–∞–±–ª–æ–Ω –¥–ª—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö HuggingFace |
| `--output`       | str    | `augmented_captioned_internvl3_2b.jsonl` | –ü—É—Ç—å –∫ –≤—ã—Ö–æ–¥–Ω–æ–º—É JSONL-—Ñ–∞–π–ª—É |
| `--resolution`   | int    | `224`                                | –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ |
| `--batch-size`   | int    | `64`                                 | –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ |
| `--temperature`  | float  | `0.01`                               | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ |
| `--tp`           | int    | `1`                                  | –ß–∏—Å–ª–æ GPU |
| `--session-len`  | int    | `16384`                              | –†–∞–∑–º–µ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ |
| `--timeout`      | int    | `1`                                  | –¢–∞–π–º–∞—É—Ç –ø—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ SVG –≤ PNG |
| `--start-index`  | int    | `0`                                  | –ò–Ω–¥–µ–∫—Å, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–∞—á–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞—Ç–∞—Å–µ—Ç–∞ |
| `--max-samples`  | int    | `None`                               | –õ–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ |
| `--seed`         | int    | `12343`                              | –§–∏–∫—Å–∏—Ä—É–µ–º —Ä–∞–Ω–¥–æ–º |


#### –§–æ—Ä–º–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–û–ø–∏—Å–∞–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSONL:

```json
{
  "hash": "a1b2c3d4...",
  "caption": "A blue circular icon with a power symbol",
  "source": "InternVL3-2B",
  "prompt": "Describe this object in 10 words or less, concise style. Response in English."
}
```

## –û–±—É—á–µ–Ω–∏–µ LLM

### –ü—Ä–∏–º–µ—Ä—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö SVG

<img src="https://github.com/CTLab-ITMO/Text2SVG/blob/main/imgs/generated_comp.png?raw=true" alt="Generated SVG examples" width="600"/>

### –û–±—É—á–µ–Ω–∏–µ

–î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ [Unsloth](https://github.com/unslothai/unsloth).

#### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏

```bash
cd Text2SVG/llm4svg
pip install unsloth transformers datasets wandb
```

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è

–°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è (`run_training.py`) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- **–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å**: Qwen2.5-Coder-32B-Instruct
- **–î–∞—Ç–∞—Å–µ—Ç**: VectorGraphics/svg-corpus
- **LoRA-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: r=128, alpha=32, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º —Å–ª–æ—è–º –≤–Ω–∏–º–∞–Ω–∏—è
- **–û–±—É—á–µ–Ω–∏–µ**: 1 —ç–ø–æ—Ö–∞, —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ 20, –∞–∫–∫—É–º—É–ª—è—Ü–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤ ‚Äî 8 —à–∞–≥–æ–≤
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: AdamW 8-bit —Å –∫–æ—Å–∏–Ω—É—Å–Ω—ã–º scheduler'–æ–º
- **–ü–∞–º—è—Ç—å**: 4-–±–∏—Ç–Ω–∞—è –∫–≤–∞–Ω—Ç–æ–≤–∫–∞ + gradient checkpointing

#### –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```bash
python3 run_training.py
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `run_training.py`:

```python
# –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏
model_name = "Qwen2.5-Coder-32B-Instruct"

# LoRA –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
r = 128                   # LoRA rank
lora_alpha = 32           # LoRA alpha
lora_dropout = 0          # LoRA dropout

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è
per_device_train_batch_size = 20
gradient_accumulation_steps = 8
learning_rate = 5e-5
num_train_epochs = 1
```

### –ò–Ω—Ñ–µ—Ä–µ–Ω—Å

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è SVG –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–æ–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏:

```bash
python3 run_eval.py
```

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç –≤ `run_eval.py`:

```python
inputs = tokenizer([
    inf_prompt.format(
        "A blue circular button with power symbol",  # –í–∞—à–µ –æ–ø–∏—Å–∞–Ω–∏–µ
        "",  # –û—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
    )
], return_tensors="pt").to("cuda")
```

## SVG-—ç–Ω–∫–æ–¥–µ—Ä

–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ SVG. –≠–Ω–∫–æ–¥–µ—Ä –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ [ModernBERT](https://github.com/AnswerDotAI/ModernBERT), –Ω–æ –æ–±—É—á–µ–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –Ω–∞ –∫–æ—Ä–ø—É—Å–µ SVG –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ —Å–µ–º–∞–Ω—Ç–∏–∫–∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

SVG-—ç–Ω–∫–æ–¥–µ—Ä —Å–ª–µ–¥—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ ModernBERT —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–ª—é—á–µ–≤—ã–º–∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è–º–∏:
- –ö–∞—Å—Ç–æ–º–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä, –æ–±—É—á–µ–Ω–Ω—ã–π –Ω–∞ –∫–æ—Ä–ø—É—Å–µ SVG —Å –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏ –¥–ª—è SVG-—Ç–µ–≥–æ–≤, –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π –¥–ª–∏–Ω—ã –¥–æ 8192 —Ç–æ–∫–µ–Ω–æ–≤
- –î–æ—Å—Ç—É–ø–µ–Ω –≤ –¥–≤—É—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö –º–æ–¥–µ–ª–∏: base –∏ large

### –ü—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è

#### –û–±—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞

SVG-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –±—ã–ª –æ–±—É—á–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `transformers` –Ω–∞ –±–æ–ª—å—à–æ–º –∫–æ—Ä–ø—É—Å–µ SVG. –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –†–∞–∑–º–µ—Ä —Å–ª–æ–≤–∞—Ä—è: 50,368 —Ç–æ–∫–µ–Ω–æ–≤
- –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è SVG-—Ç–µ–≥–æ–≤ (`<svg>`, `<path>`, `<rect>`, –∏ —Ç.–¥.)
- –í—ã–¥–µ–ª–µ–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è SVG-–∞—Ç—Ä–∏–±—É—Ç–æ–≤ (`viewBox`, `fill`, `stroke`, –∏ —Ç.–¥.)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π SVG –∏ –¥–∞–Ω–Ω—ã—Ö –ø—É—Ç–µ–π

#### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

–û–±—É—á–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç –ø–æ—ç—Ç–∞–ø–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É ModernBERT —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –¥–ª–∏–Ω—ã –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:

| **–≠—Ç–∞–ø** | **–î–ª–∏–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞** | **–¢–æ–∫–µ–Ω—ã (Base)** | **–¢–æ–∫–µ–Ω—ã (Large)** |
|----------|-------------------|-------------------|-------------------|
| –§–∞–∑–∞ 1   | 1024             | 12 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤     | 30 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤     |
| –§–∞–∑–∞ 2   | 8192             | 3 –º–∏–ª–ª–∏–∞—Ä–¥–∞       | 9 –º–∏–ª–ª–∏–∞—Ä–¥–æ–≤      |
| –§–∞–∑–∞ 3   | 8192             | 2 –º–∏–ª–ª–∏–∞—Ä–¥–∞       | 3 –º–∏–ª–ª–∏–∞—Ä–¥–∞       |

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–±—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã –≤ `svg-encoder/training/configs/`.

### –ó–∞–¥–∞—á–∏ –æ—Ü–µ–Ω–∫–∏

–ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–µ–Ω—á–º–∞—Ä–∫–∞ **svg-super-glue**, –∫–æ—Ç–æ—Ä—ã–π –≤–∫–ª—é—á–∞–µ—Ç —Ç—Ä–∏ –∑–∞–¥–∞—á–∏:

| **–ó–∞–¥–∞—á–∞** | **–û–ø–∏—Å–∞–Ω–∏–µ** | **–í—ã–∑–æ–≤** | **–ú–µ—Ç—Ä–∏–∫–∞** |
|------------|--------------|-----------|-------------|
| **AB-test Classification** | –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è SVG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –æ–¥–Ω—É –ª–∞—Ç–∏–Ω—Å–∫—É—é –±—É–∫–≤—É ('a' –∏–ª–∏ 'b') | –°—Ö–æ–∂–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–Ω—É—Ç—Ä–∏ –¥–æ–º–µ–Ω–∞ —à—Ä–∏—Ñ—Ç–æ–≤ | –¢–æ—á–Ω–æ—Å—Ç—å |
| **Is-optimized Detection** | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —è–≤–ª—è—é—Ç—Å—è –ª–∏ –¥–≤–∞ SVG —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º–∏ (–¥–æ/–ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏) | –í–∏–∑—É–∞–ª—å–Ω–æ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã, –Ω–æ —Ä–∞–∑–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è | –¢–æ—á–Ω–æ—Å—Ç—å |
| **Multi-class Classification** | –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è SVG –ø–æ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (love, food, phone, photography, sun) | –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å—Ç–∏–ª—è—Ö | –¢–æ—á–Ω–æ—Å—Ç—å |

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–¢–µ–∫—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ –∑–∞–¥–∞—á–∞–º:

| **–ú–æ–¥–µ–ª—å** | **AB-test** | **Is-optimized** | **Multi-class** |
|------------|-------------|------------------|-----------------|
| ModernBERT-base | 90.3 | 88.0 | 33.2 |
| SVG-BERT-base | 96.7 | 96.0 | 50.8 |
| SVG-BERT-large | TBD | TBD | 60.6 |

#### –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏
–ó–∞–ø—É—Å–∫ –æ—Ü–µ–Ω–∫–∏ –Ω–∞ [–∑–∞–¥–∞—á–∞—Ö](https://huggingface.co/datasets/VectorGraphics/svg-super-glue) svg-super-glue:

```bash
cd svg-encoder/evaluation/svg-super-glue/model_validation
python train_sweeps.py
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–π –≤ `sweep_config.yaml`:

```yaml
method: grid
parameters:
  learning_rate:
    values: [1e-5, 2e-5, 5e-5]
  batch_size:
    values: [16, 32]
  num_train_epochs:
    values: [3, 5]
  task_name:
    values: ["ab-test", "is_optimized", "multi-class-classification"]
```

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **PyTorch** - –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **Transformers & Tokenizers** (HuggingFace) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–π —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä
- **ModernBERT** - –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å–∫—Ä–∏–ø—Ç—ã –æ–±—É—á–µ–Ω–∏—è
- **Weights & Biases** - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- **Datasets** - –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—É—á–µ–Ω–∏—è

–û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞:
- **CPU**: AMD EPYC 9654 (96 —è–¥–µ—Ä)
- **GPU**: NVIDIA RTX Ada 6000

### –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- [ModernBERT](https://github.com/AnswerDotAI/ModernBERT) ‚Äî –∑–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é –±–∞–∑–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
- [HuggingFace](https://huggingface.co/) ‚Äî –∑–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ transformers –∏ tokenizers
- [Weights & Biases](https://wandb.ai/) ‚Äî –∑–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
